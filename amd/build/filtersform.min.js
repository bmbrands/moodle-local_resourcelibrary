/**
 * A javascript module to retrieve the filter form and put it in the right location.
 * This will also make sure that submit of this form will be sent to the filter form.
 *
 * @copyright  2020 CALL Learning 2020 - Laurent David laurent@call-learning.fr
 * @license    http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later
 */
define("local_resourcelibrary/filtersform",["jquery","core/config"],(function($,config){var FiltersForm={};function getFilterData(target,ignoresesskey){var data=$(target).serializeArray(),filterdata={},sesskeyconfirmed=!1;data.forEach((function(d){if("sesskey"===d.name)sesskeyconfirmed=d.value===config.sesskey;else{var parsename=d.name.match(/(customfield_)?(\w+)\[(\w+)\]\[?(\w*)\]?/);if(parsename){var hasCustomShortName=!1;parsename.length>=4&&(parsename.shift(),hasCustomShortName=!0);var rootname=parsename[1],type=parsename[2];void 0===filterdata[rootname]&&(filterdata[rootname]={}),hasCustomShortName&&void 0===filterdata[rootname].shortname&&Object.defineProperty(filterdata[rootname],"shortname",{enumerable:!0,value:rootname}),"_qf__force_multiselect_submission"!=d.value&&(void 0===filterdata[rootname].value?Object.defineProperty(filterdata[rootname],type,{enumerable:!0,value:d.value,writable:!0}):filterdata[rootname].value+=","+d.value)}}}));var filterdataarray=Object.values(filterdata).filter((function(v){return"date"==v.type&&void 0!==v.value?v.value.split(",").length>3:void 0!==v.value||null===v.value}));return!(!sesskeyconfirmed&&!ignoresesskey)&&filterdataarray}return FiltersForm.init=function(selector){var target=$(selector);target.on("submit","form",(function(e){e.preventDefault();var filterdataarray=getFilterData(target.children("form"),!1);filterdataarray&&$(document).trigger("resourcelibrary-filters-change",[filterdataarray])})),$("#id_resetbutton").on("click",(function(){$(target).children("form.resourcelibrary-filters-form")[0].reset()}));var filterdataarray=getFilterData(target.children("form"),!0);$(document).trigger("resourcelibrary-filters-inited",[filterdataarray])},FiltersForm}));

//# sourceMappingURL=filtersform.min.js.map