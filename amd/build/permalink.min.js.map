{"version":3,"sources":["../src/permalink.js"],"names":["define","$","config","Templates","setupCopyLink","triggerid","targetid","document","querySelector","addEventListener","getElementById","select","execCommand","init","on","e","filterarray","catalogURL","URL","wwwroot","forEach","f","fieldname","shortname","value","searchParams","append","operator","type","render","url","toString","then","html","js","replaceNodeContents"],"mappings":"AAqBAA,OAAM,mCAAC,CAAC,QAAD,CAAW,aAAX,CAA0B,gBAA1B,CAAD,CAA8C,SAAUC,CAAV,CAAaC,CAAb,CAAqBC,CAArB,CAAgC,CAgChF,MA9BgB,CAENC,aAFM,CAEU,SAAUC,CAAV,CAAqBC,CAArB,CAA+B,CACrDC,QAAQ,CAACC,aAAT,CAAuB,IAAMH,CAA7B,EAAwCI,gBAAxC,CAAyD,OAAzD,CACI,UAAY,CACRF,QAAQ,CAACG,cAAT,CAAwBJ,CAAxB,EAAkCK,MAAlC,GACAJ,QAAQ,CAACK,WAAT,CAAqB,MAArB,CACH,CAJL,CAKH,CARe,CAUNC,IAVM,CAUC,UAAY,CACzBZ,CAAC,CAACM,QAAD,CAAD,CAAYO,EAAZ,CAAe,gCAAf,CAAiD,SAAUC,CAAV,CAAaC,CAAb,CAA0B,CACnE,GAAIC,CAAAA,CAAU,CAAG,GAAIC,CAAAA,GAAJ,CAAQhB,CAAM,CAACiB,OAAP,CAAiB,kCAAzB,CAAjB,CACAH,CAAW,CAACI,OAAZ,CAAoB,SAAUC,CAAV,CAAa,CAC7B,GAAMC,CAAAA,CAAS,CAAG,eAAiBD,CAAC,CAACE,SAArC,CACA,GAAIF,CAAC,CAACG,KAAN,CAAa,CACTP,CAAU,CAACQ,YAAX,CAAwBC,MAAxB,CAA+BJ,CAAS,CAAG,YAA3C,CAAyDD,CAAC,CAACM,QAA3D,EACAV,CAAU,CAACQ,YAAX,CAAwBC,MAAxB,CAA+BJ,CAAS,CAAG,SAA3C,CAAsDD,CAAC,CAACG,KAAxD,EACAP,CAAU,CAACQ,YAAX,CAAwBC,MAAxB,CAA+BJ,CAAS,CAAG,QAA3C,CAAqDD,CAAC,CAACO,IAAvD,CACH,CACJ,CAPD,EAQAzB,CAAS,CAAC0B,MAAV,CAAiB,iCAAjB,CACI,CAACC,GAAG,CAAEb,CAAU,CAACc,QAAX,EAAN,CADJ,EACkCC,IADlC,CAEI,SAAUC,CAAV,CAAgBC,CAAhB,CAAoB,CAChB/B,CAAS,CAACgC,mBAAV,CAA8B,4BAA9B,CAA4DF,CAA5D,CAAkEC,CAAlE,CACH,CAJL,CAMH,CAhBL,CAkBH,CA7Be,CA+BnB,CAjCK,CAAN","sourcesContent":["// This file is part of Moodle - http://moodle.org/\n//\n// Moodle is free software: you can redistribute it and/or modify\n// it under the terms of the GNU General Public License as published by\n// the Free Software Foundation, either version 3 of the License, or\n// (at your option) any later version.\n//\n// Moodle is distributed in the hope that it will be useful,\n// but WITHOUT ANY WARRANTY; without even the implied warranty of\n// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n// GNU General Public License for more details.\n//\n// You should have received a copy of the GNU General Public License\n// along with Moodle.  If not, see <http://www.gnu.org/licenses/>.\n/**\n * A javascript module to display the current's filter permanent link\n *\n * @package    local_resourcelibrary\n * @copyright  2020 CALL Learning 2020 - Laurent David laurent@call-learning.fr\n * @license    http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later\n */\ndefine(['jquery', 'core/config', 'core/templates'], function ($, config, Templates) {\n\n    var Permalink = {};\n\n    Permalink.setupCopyLink = function (triggerid, targetid) {\n        document.querySelector(\"#\" + triggerid).addEventListener(\"click\",\n            function () {\n                document.getElementById(targetid).select();\n                document.execCommand(\"copy\");\n            });\n    };\n\n    Permalink.init = function () {\n        $(document).on('resourcelibrary-filters-change', function (e, filterarray) {\n                let catalogURL = new URL(config.wwwroot + '/local/resourcelibrary/index.php');\n                filterarray.forEach(function (f) {\n                    const fieldname = 'customfield_' + f.shortname;\n                    if (f.value) {\n                        catalogURL.searchParams.append(fieldname + '[operator]', f.operator);\n                        catalogURL.searchParams.append(fieldname + '[value]', f.value);\n                        catalogURL.searchParams.append(fieldname + '[type]', f.type);\n                    }\n                });\n                Templates.render('local_resourcelibrary/permalink',\n                    {url: catalogURL.toString()}).then(\n                    function (html, js) {\n                        Templates.replaceNodeContents('#resourcelibrary-permalink', html, js);\n                    }\n                );\n            }\n        );\n    };\n    return Permalink;\n});\n"],"file":"permalink.min.js"}