{"version":3,"sources":["../src/permalink.js"],"names":["define","$","config","Templates","Permalink","catalogURL","setupCopyLink","triggerid","targetid","document","querySelector","addEventListener","getElementById","select","execCommand","init","URL","window","location","href","on","e","filterarray","forEach","f","fieldname","shortname","value","searchParams","append","operator","type","render","url","toString","then","html","js","replaceNodeContents"],"mappings":"AAqBAA,OAAM,mCAAC,CAAC,QAAD,CAAW,aAAX,CAA0B,gBAA1B,CAAD,CAA8C,SAAUC,CAAV,CAAaC,CAAb,CAAqBC,CAArB,CAAgC,CAEhF,GAAIC,CAAAA,CAAS,CAAG,CACNC,UADM,CACO,IADP,CAENC,aAFM,CAEU,SAAUC,CAAV,CAAqBC,CAArB,CAA+B,CACrDC,QAAQ,CAACC,aAAT,CAAuB,IAAMH,CAA7B,EAAwCI,gBAAxC,CAAyD,OAAzD,CACI,UAAY,CACRF,QAAQ,CAACG,cAAT,CAAwBJ,CAAxB,EAAkCK,MAAlC,GACAJ,QAAQ,CAACK,WAAT,CAAqB,MAArB,CACH,CAJL,CAKH,CARe,CAAhB,CAUAV,CAAS,CAACW,IAAV,CAAiB,UAAY,CACzBX,CAAS,CAACC,UAAV,CAAuB,GAAIW,CAAAA,GAAJ,CAAQC,MAAM,CAACC,QAAP,CAAgBC,IAAxB,CAAvB,CACAlB,CAAC,CAACQ,QAAD,CAAD,CAAYW,EAAZ,CAAe,gCAAf,CAAiD,SAAUC,CAAV,CAAaC,CAAb,CAA0B,CACnEA,CAAW,CAACC,OAAZ,CAAoB,SAAUC,CAAV,CAAa,CAC7B,GAAMC,CAAAA,CAAS,CAAG,eAAiBD,CAAC,CAACE,SAArC,CACA,GAAIF,CAAC,CAACG,KAAN,CAAa,CACTvB,CAAS,CAACC,UAAV,CAAqBuB,YAArB,CAAkCC,MAAlC,CAAyCJ,CAAS,CAAG,YAArD,CAAmED,CAAC,CAACM,QAArE,EACA1B,CAAS,CAACC,UAAV,CAAqBuB,YAArB,CAAkCC,MAAlC,CAAyCJ,CAAS,CAAG,SAArD,CAAgED,CAAC,CAACG,KAAlE,EACAvB,CAAS,CAACC,UAAV,CAAqBuB,YAArB,CAAkCC,MAAlC,CAAyCJ,CAAS,CAAG,QAArD,CAA+DD,CAAC,CAACO,IAAjE,CACH,CACJ,CAPD,EAQA5B,CAAS,CAAC6B,MAAV,CAAiB,iCAAjB,CACI,CAACC,GAAG,CAAE7B,CAAS,CAACC,UAAV,CAAqB6B,QAArB,EAAN,CADJ,EAC4CC,IAD5C,CAEI,SAAUC,CAAV,CAAgBC,CAAhB,CAAoB,CAChBlC,CAAS,CAACmC,mBAAV,CAA8B,4BAA9B,CAA4DF,CAA5D,CAAkEC,CAAlE,CACH,CAJL,CAMH,CAfL,CAiBH,CAnBD,CAoBA,MAAOjC,CAAAA,CACV,CAjCK,CAAN","sourcesContent":["// This file is part of Moodle - http://moodle.org/\n//\n// Moodle is free software: you can redistribute it and/or modify\n// it under the terms of the GNU General Public License as published by\n// the Free Software Foundation, either version 3 of the License, or\n// (at your option) any later version.\n//\n// Moodle is distributed in the hope that it will be useful,\n// but WITHOUT ANY WARRANTY; without even the implied warranty of\n// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n// GNU General Public License for more details.\n//\n// You should have received a copy of the GNU General Public License\n// along with Moodle.  If not, see <http://www.gnu.org/licenses/>.\n/**\n * A javascript module to display the current's filter permanent link\n *\n * @package    local_resourcelibrary\n * @copyright  2020 CALL Learning 2020 - Laurent David laurent@call-learning.fr\n * @license    http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later\n */\ndefine(['jquery', 'core/config', 'core/templates'], function ($, config, Templates) {\n\n    var Permalink = {};\n    Permalink.catalogURL = null;\n    Permalink.setupCopyLink = function (triggerid, targetid) {\n        document.querySelector(\"#\" + triggerid).addEventListener(\"click\",\n            function () {\n                document.getElementById(targetid).select();\n                document.execCommand(\"copy\");\n            });\n    };\n\n    Permalink.init = function () {\n        Permalink.catalogURL = new URL(window.location.href);\n        $(document).on('resourcelibrary-filters-change', function (e, filterarray) {\n                filterarray.forEach(function (f) {\n                    const fieldname = 'customfield_' + f.shortname;\n                    if (f.value) {\n                        Permalink.catalogURL.searchParams.append(fieldname + '[operator]', f.operator);\n                        Permalink.catalogURL.searchParams.append(fieldname + '[value]', f.value);\n                        Permalink.catalogURL.searchParams.append(fieldname + '[type]', f.type);\n                    }\n                });\n                Templates.render('local_resourcelibrary/permalink',\n                    {url: Permalink.catalogURL.toString()}).then(\n                    function (html, js) {\n                        Templates.replaceNodeContents('#resourcelibrary-permalink', html, js);\n                    }\n                );\n            }\n        );\n    };\n    return Permalink;\n});\n"],"file":"permalink.min.js"}